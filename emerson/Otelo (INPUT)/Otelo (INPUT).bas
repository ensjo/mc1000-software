0  CLEAR 512,15535: GOSUB 65000
1 Y = 277:X = 278
2 K0 = 283: REM ENDERECO DE KEY0 (INKEY$)
10  HGR : POKE 245,153
15  POKE Y,1: POKE X,10: INVERSE :N =  USR (" O T E L O "): NORMAL
20  POKE Y,10: POKE X,2:N =  USR ("QUER JOGAR PRIMEIRO? (S OU N)")
21  POKE K0,0
30 X$ =  CHR$ ( PEEK (K0)):CP = (1 AND X$ = "S") OR (2 AND X$ = "N")
40  IF CP = 0 THEN 30
45  CALL 54492: REM LIMPA VRAM
50  DIM S$(2,1)
51 S$(0,0) =  CHR$ (96) +  CHR$ (97):S$(0,1) =  CHR$ (98) + " "
52 S$(1,0) =  CHR$ (100) +  CHR$ (101):S$(1,1) =  CHR$ (102) +  CHR$ (103)
53 S$(2,0) =  CHR$ (104) +  CHR$ (105):S$(2,1) =  CHR$ (106) +  CHR$ (107)
100  DIM B(8,8),C(8),D(8,2),X(60),Y(60),N(60)
110 B(4,4) = 1:B(4,5) = 2:B(5,4) = 2:B(5,5) = 1
120  RESTORE 130: FOR F = 1 TO 8: READ D(F,1),D(F,2): NEXT
130  DATA -1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1
500  GOSUB 1000
505  IF CS + PS = 64 THEN 4000
510 EG = 0: IF CP = 1 THEN  GOSUB 2000: GOSUB 1000: IF EG = 1 THEN 4000
515  IF CS + PS = 64 THEN 4000
520  IF CP = 2 THEN  GOSUB 3000
530  GOTO 500
1000  POKE Y,0: POKE X,9:N =  USR ("1 2 3 4 5 6 7 8"):PS = 0:CS = 0
1010  FOR F = 1 TO 8: POKE Y,(F - 1) * 2 + 2: POKE X,6:N =  USR ( STR$ (F)): FOR G = 1 TO 8
1020  POKE X,(G - 1) * 2 + 8: FOR H = 0 TO 1: POKE Y,(F - 1) * 2 + 1 + H:N =  USR (S$(B(F,G),H)): NEXT H
1030 PS = PS +  ABS (B(F,G) = 1)
1040 CS = CS +  ABS (B(F,G) = 2)
1050  NEXT G,F
1052  FOR F = 0 TO 15
1054  POKE Y,17: POKE X,8 + F:N =  USR ( CHR$ (97))
1056  POKE Y,F + 1: POKE X,24:N =  USR ( CHR$ (98))
1058  NEXT F: POKE Y,17: POKE X,24:N =  USR ( CHR$ (99))
1060  POKE Y,11: POKE X,1:N =  USR ("VOCE"): POKE X,25:N =  USR ("COMPUT")
1063  POKE Y,13: POKE X,2:N =  USR (S$(1,0) +  CHR$ (98)): POKE Y,14:N =  USR (S$(1,1) +  CHR$ (98)): POKE Y,15:N =  USR ( CHR$ (97) +  CHR$ (97) +  CHR$ (99)): POKE Y,13: POKE X,27:N =  USR (S$(2,0) +  CHR$ (98)): POKE Y,14:N =  USR (S$(2,1) +  CHR$ (98)): POKE Y,15:N =  USR ( CHR$ (97) +  CHR$ (97) +  CHR$ (99))
1066  POKE Y,7: POKE X,2:N =  USR ( RIGHT$ ( STR$ (PS),2)): POKE X,27:N =  USR ( RIGHT$ ( STR$ (CS),2))
1070  RETURN
1100  POKE X,0: FOR F = 19 TO 23: POKE Y,F:N =  USR ("                                "): NEXT F: RETURN
2000  GOSUB 1100: POKE Y,22: POKE X,2:N =  USR ("PARA ONDE?  (LINHA E COLUNA)")
2001  POKE K0,0
2002 I$ =  CHR$ ( PEEK (K0)): IF I$ < "0" OR I$ > "9" THEN 2002
2003 IX =  VAL (I$): POKE Y,19: POKE X,15:N =  USR (I$)
2004  POKE K0,0
2005 I$ =  CHR$ ( PEEK (K0)): IF I$ < "0" OR I$ > "9" THEN 2005
2006 IY =  VAL (I$): POKE Y,19: POKE X,17:N =  USR (I$)
2007  IF IX = 0 THEN EG = 1: RETURN
2008  IF IX = 9 THEN CP = 2: RETURN
2010  IF IX < 1 OR IX > 8 OR IY < 1 OR IY > 8 THEN 2000
2020  IF B(IX,IY) = 0 THEN 2070
2040  GOSUB 1100: POKE Y,22: POKE X,8:N =  USR ("QUADRADO OCUPADO"): FOR F = 1 TO 900: NEXT F
2050  GOTO 2000
2070 NF = 0: FOR F = 1 TO 8:CF = 0: IF IX + D(F,1) = 0 OR IX + D(F,1) = 9 THEN 2075
2071  IF IY + D(F,2) = 0 OR IY + D(F,2) = 9 THEN 2075
2072  IF B(IX + D(F,1),IY + D(F,2)) = 2 THEN CF = 1:NF = 1
2075 C(F) = 0: IF CF THEN C(F) = F
2080  NEXT F
2090  IF NF THEN 2120
2100  GOSUB 1100: POKE Y,22: POKE X,8:N =  USR ("LONGE DA JOGADA"): FOR F = 1 TO 900: NEXT F
2110  GOTO 2000
2120 RF = 0: FOR Q = 1 TO 8: IF C(Q) = 0 THEN 2170
2130 XP = IX:YP = IY
2140 XP = XP + D(Q,1):YP = YP + D(Q,2): IF XP = 0 OR XP = 9 OR YP = 0 OR YP = 9 THEN C(Q) = 0: GOTO 2170
2145  IF B(XP,YP) = 2 THEN 2140
2150  IF B(XP,YP) = 1 THEN RF = 1: GOTO 2170
2160  IF B(XP,YP) = 0 THEN C(Q) = 0
2170  NEXT Q
2180  IF RF THEN 2210
2190  GOSUB 1100: POKE Y,22: POKE X,3:N =  USR ("JOGADA NAO GANHA A TRILHA"): FOR F = 1 TO 900: NEXT F
2200  GOTO 2000
2210  FOR Q = 1 TO 8: IF C(Q) = 0 THEN 2250
2220 XP = IX + D(Q,1):YP = IY + D(Q,2)
2230  IF B(XP,YP) = 1 THEN 2250
2240 B(XP,YP) = 1:XP = XP + D(Q,1):YP = YP + D(Q,2): GOTO 2230
2250  NEXT Q
2260 B(IX,IY) = 1
2270 CP = 2: RETURN
3000  GOSUB 1100: POKE Y,22: POKE X,11:N =  USR ("PENSANDO..."):NF = 1:MX = 0: FOR IX = 1 TO 8: FOR IY = 1 TO 8
3010  IF B(IX,IY) THEN 3070
3020  FOR F = 1 TO 8:XP = IX:YP = IY:DX = D(F,1):DY = D(F,2):RF = 0
3030 XP = XP + DY:YP = YP + DX: IF XP = 0 OR XP = 9 OR YP = 0 OR YP = 9 THEN 3060
3040  IF B(XP,YP) = 1 THEN RF = 1: GOTO 3030
3050  IF B(XP,YP) = 2 AND RF = 1 THEN N(NF) = F:X(NF) = IX:Y(NF) = IY:NF = NF + 1:F = 9
3060  NEXT F
3070  NEXT IY,IX:NF = NF - 1
3075  IF NF = 0 THEN 3300
3080  FOR F = 1 TO NF: FOR F = 1 TO NF:IX = X(F):IY = Y(F):DX = D(N(F),1):DY = D(N(F),2):CF = 0
3090 IX = IX + DY:IY = IY + DX: IF B(IX,IY) = 1 THEN CF = CF + 1: GOTO 3090
3100  IF CF > MX THEN MX = CF:MF = F
3110  NEXT F
3180  FOR F = 1 TO 8:IX = X(MF):IY = Y(MF):DX = D(F,1):DY = D(F,2)
3190 IX = IX + DY:IY = IY + DX
3195  IF IX < 1 OR IX > 8 OR IY < 1 OR IY > 8 THEN 3260
3200  IF B(IX,IY) = 1 THEN 3190
3210  IF B(IX,IY) = 2 THEN 3230
3220  IF B(IX,IY) = 0 THEN 3260
3230 IX = X(MF):IY = Y(MF)
3235 B(IX,IY) = 2:IX = IX + DY:IY = IY + DX
3240  IF B(IX,IY) = 2 THEN 3260
3250  GOTO 3235
3260  NEXT F
3265  POKE Y,19: POKE X,14:N =  USR ( STR$ (X(MF)) +  STR$ (Y(MF)))
3270 CP = 1: RETURN
3300  GOSUB 1100: POKE Y,22: POKE X,8:N =  USR ("NAO POSSO JOGAR"): FOR F = 1 TO 900: NEXT F:CP = 1: RETURN
4000  IF PS > CS THEN 5000
4010  IF PS = CS THEN 6000
4020  GOSUB 1100: POKE Y,22: POKE X,11:N =  USR ("FOI FACIL")
4025  FOR F = 1 TO 1500: NEXT F
4030  GOSUB 1100: POKE Y,22: POKE X,2:N =  USR ("QUER JOGAR OUTRA VEZ?  (S/N)")
4040  POKE K0,0
4045 A$ =  CHR$ ( PEEK (K0)): IF A$ <  > "S" AND A$ <  > "N" THEN 4045
4050  IF A$ = "S" THEN  RUN 1
4060  END
5000  GOSUB 1100: POKE Y,22: POKE X,8:N =  USR ("VOCE TEVE SORTE")
5010  GOTO 4025
6000  GOSUB 1100: POKE Y,22: POKE X,11:N =  USR ("EMPATAMOS")
6010  GOTO 4025
64999  END
65000  REM INSTALADOR
65010  TEXT : HOME : PRINT "INSTALANDO HGRPRINT. AGUARDE..."
65020  RESTORE 65000
65030  READ E: IF E =  - 1 THEN  RETURN
65040  READ B: IF B =  - 1 THEN 65030
65050  POKE E,B:E = E + 1: GOTO 65040
65100  REM CONFIGURA USR()
65110  DATA 771
65120  DATA 195,176,60,-1
65130  REM ROTINA DE IMPRESSAO EM HGR
65140  DATA 15536
65150  DATA 205,161,232,200,71,35,35,78,35,102,105,229,33,21,1,86,35,94,33,,128,25,235,225,205,134,200,126,214,32,56,41
65160  DATA 229,213,197,38,,111,41,41,41,1,,61,9,58,82,3,214,1,159,47,79,6,8,126,169,18,35,123,198,32,95,122
65170  DATA 206,,87,16,242,193,209,225,19,35,16,207,195,121,200,-1
65180  REM TABELA DE CARACTERES
65190  DATA 15616
65200  DATA ,,,,,,,,32,32,32,32,32,,32,,136,136,136,,,,,,,136,168,136,168,136,,
65210  DATA 32,168,128,32,8,168,32,,136,8,32,32,32,128,136,,32,136,136,32,34,136,40,10,40,8,32,,,,,
65220  DATA 8,32,128,128,128,32,8,,128,32,8,8,8,32,128,,,136,32,168,32,136,,,,32,32,168,32,32,,
65230  DATA ,,,,,40,8,32,,,,168,,,,,,,,,,32,32,,8,8,32,32,32,128,128,
65240  DATA 32,136,168,136,136,136,32,,32,160,32,32,32,32,168,,32,136,8,32,32,128,168,,32,136,8,32,8,136,32,
65250  DATA 8,136,136,168,8,8,8,,168,128,160,8,8,136,32,,32,136,128,160,136,136,32,,168,8,8,32,32,128,128,
65260  DATA 32,136,136,32,136,136,32,,32,136,136,40,8,136,32,,,32,32,,,32,32,,,32,32,,,32,32,128
65270  DATA 2,8,32,128,32,8,2,,,,168,,168,,,,128,32,8,2,8,32,128,,32,136,8,32,32,,32,
65280  DATA 32,136,136,168,168,128,40,,32,136,136,168,136,136,136,,160,136,136,160,136,136,160,,32,136,128,128,128,136,32,
65290  DATA 160,136,136,136,136,136,160,,168,128,128,160,128,128,168,,168,128,128,160,128,128,128,,32,136,128,168,136,136,32,
65300  DATA 136,136,136,168,136,136,136,,168,32,32,32,32,32,168,,8,8,8,8,8,136,32,,136,136,160,160,136,136,136,
65310  DATA 128,128,128,128,128,128,168,,136,168,168,136,136,136,136,,8,136,168,168,136,136,136,,168,136,136,136,136,136,168,
65320  DATA 160,136,136,160,128,128,128,,32,136,136,136,136,136,32,8,160,136,136,160,136,136,136,,32,136,128,32,8,136,32,
65330  DATA 168,32,32,32,32,32,32,,136,136,136,136,136,136,168,,136,136,136,136,136,32,32,,136,136,136,136,168,168,136,
65340  DATA 136,136,168,32,168,136,136,,136,136,136,32,32,32,32,,168,8,8,32,128,128,168,,40,32,32,32,32,32,40,
65350  DATA 128,128,32,32,32,8,8,,40,8,8,8,8,8,40,,,32,168,136,,,,,,,,,,,,170
65360  REM TABULEIRO
65361  DATA 170,128,128,128,128,128,128,128
65362  DATA 170,,,,,,,
65363  DATA 128,128,128,128,128,128,128,128
65364  DATA 128,,,,,,,
65370  REM PECA VERMELHA
65371  DATA 170,128,128,131,143,143,191,191
65372  DATA 170,,192,240,252,252,255,255
65373  DATA 191,191,191,143,143,131,128,128
65374  DATA 255,255,255,252,252,240,192,
65380  REM PECA AMARELA
65381  DATA 170,128,128,129,133,133,149,149
65382  DATA 170,,64,80,84,84,85,85
65383  DATA 149,149,149,133,133,129,128,128
65384  DATA 85,85,85,84,84,80,64,
65535  DATA -1,-1
