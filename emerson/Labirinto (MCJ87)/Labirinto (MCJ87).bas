0  CLEAR 512,15535: GOSUB 65000
1  REM ** LABIRINTO **
2  REM ** REVISTA MICROCOMPUTADOR - JOGOS **
3  REM ** VERSAO PARA MC-1000 ADAPTADA DE VERSAO PARA ZX-SPECTRUM **
10  TEXT : HOME : INVERSE : PRINT  TAB( 11);"LABIRINTO"; TAB( 32): NORMAL
20  PRINT : PRINT "PARA ANDAR NO LABIRINTO, VOCE": PRINT "DEVE USAR AS TECLAS:"
30  PRINT : PRINT "<M> PARA IR EM FRENTE."
40  PRINT "<P> E <O> PARA VIRAR PARA OS": PRINT "LADOS."
50  PRINT "<R> PARA DAR MEIA-VOLTA."
60  PRINT : PRINT "BOA SORTE E MUITO CUIDADO PARA": PRINT "NAO SE PERDER!"
65  PRINT : PRINT "APERTE QUALQUER TECLA.";: POKE 284,0
70  IF  PEEK (284) = 0 THEN 70
80  HOME
100  DIM V(10,10): DIM H(10,10)
110  GOSUB 9000
120 X = 1:Y = 1:DX = 1:DY = 0
130 I = 9:IX = X +  ABS (DX =  - 1):IY = Y +  ABS (DY =  - 1)
132 I = I - 1:IX = IX + DX:IY = IY + DY
134  IF DX <  > 0 AND V(IX,IY) = 0 THEN 132
136  IF DY <  > 0 AND H(IX,IY) = 0 THEN 132
140  HGR : ON I + 1 GOSUB 6000,6001,6002,6003,6004,6005,6006,6007,6008
145 IX = IX -  ABS (DX =  - 1):IY = IY -  ABS (DY =  - 1)
150  FOR II = I TO 8
155 IX = IX - DX:IY = IY - DY: GOSUB 1000: NEXT II
156  IF DX =  - 1 AND Y = 9 AND X < 5 THEN  POKE 277,10: POKE 278,14:A =  USR ("SAIDA")
158  POKE 284,0
159 A$ =  CHR$ ( PEEK (284)): IF  asc(a$)=0 THEN 159
160  IF A$ <  > "M" THEN 190
170  IF (DX = 1 AND V(X + 1,Y) = 0) OR (DX =  - 1 AND V(X,Y) = 0) OR (DY = 1 AND H(X,Y + 1) = 0) OR (DY =  - 1 AND H(X,Y) = 0) THEN X = X + DX:Y = Y + DY
190  IF X = 1 AND Y = 9 THEN 9990
200  IF A$ = "R" THEN DX =  - DX:DY =  - DY: GOTO 130
210  IF A$ = "O" THEN 300
215  IF A$ <  > "P" THEN 130
220  IF DX <  > 0 THEN DY =  - DX:DX = 0: GOTO 130
230 DX = DY:DY = 0: GOTO 130
300  IF DX <  > 0 THEN DY = DX:DX = 0: GOTO 130
310 DX =  - DY:DY = 0: GOTO 130
1000  IF DX <  > 1 THEN 1100
1010  IF H(IX,IY + 1) = 0 THEN  ON II + 1 GOSUB 7500,7501,7502,7503,7504,7505,7506,7507,7508: GOTO 1050
1020  ON II + 1 GOSUB 7000,7001,7002,7003,7004,7005,7006,7007,7008
1050  IF H(IX,IY) = 0 THEN  ON II + 1 GOTO 8500,8501,8502,8503,8504,8505,8506,8507,8508
1060  ON II + 1 GOTO 8000,8001,8002,8003,8004,8005,8006,8007,8008
1100  IF DX <  >  - 1 THEN 1200
1110  IF H(IX,IY) = 0 THEN  ON II + 1 GOSUB 7500,7501,7502,7503,7504,7505,7506,7507,7508: GOTO 1150
1120  ON II + 1 GOSUB 7000,7001,7002,7003,7004,7005,7006,7007,7008
1150  IF H(IX,IY + 1) = 0 THEN  ON II + 1 GOTO 8500,8501,8502,8503,8504,8505,8506,8507,8508
1160  ON II + 1 GOTO 8000,8001,8002,8003,8004,8005,8006,8007,8008
1200  IF DY <  >  - 1 THEN 1300
1210  IF V(IX + 1,IY) = 0 THEN  ON II + 1 GOSUB 7500,7501,7502,7503,7504,7505,7506,7507,7508: GOTO 1250
1220  ON II + 1 GOSUB 7000,7001,7002,7003,7004,7005,7006,7007,7008
1250  IF V(IX,IY) = 0 THEN  ON II + 1 GOTO 8500,8501,8502,8503,8504,8505,8506,8507,8508
1260  ON II + 1 GOTO 8000,8001,8002,8003,8004,8005,8006,8007,8008
1300  REM
1310  IF V(IX,IY) = 0 THEN  ON II + 1 GOSUB 7500,7501,7502,7503,7504,7505,7506,7507,7508: GOTO 1350
1320  ON II + 1 GOSUB 7000,7001,7002,7003,7004,7005,7006,7007,7008
1350  IF V(IX + 1,IY) = 0 THEN  ON II + 1 GOTO 8500,8501,8502,8503,8504,8505,8506,8507,8508
1360  ON II + 1 GOTO 8000,8001,8002,8003,8004,8005,8006,8007,8008
6000  SET 110,76: DRAW 0,24: DRAW 36,0: DRAW 0, - 24: DRAW  - 36,0: RETURN
6001  SET 108,75: DRAW 0,26: DRAW 40,0: DRAW 0, - 26: DRAW  - 40,0: RETURN
6002  SET 106,74: DRAW 0,28: DRAW 44,0: DRAW 0, - 28: DRAW  - 44,0: RETURN
6003  SET 102,71: DRAW 0,34: DRAW 52,0: DRAW 0, - 34: DRAW  - 52,0: RETURN
6004  SET 94,65: DRAW 0,46: DRAW 68,0: DRAW 0, - 46: DRAW  - 68,0: RETURN
6005  SET 82,57: DRAW 0,62: DRAW 92,0: DRAW 0, - 62: DRAW  - 92,0: RETURN
6006  SET 64,45: DRAW 0,86: DRAW 128,0: DRAW 0, - 86: DRAW  - 128,0: RETURN
6007  SET 40,29: DRAW 0,118: DRAW 176,0: DRAW 0, - 118: DRAW  - 176,0: RETURN
6008  SET 8,7: DRAW 0,162: DRAW 240,0: DRAW 0, - 162: DRAW  - 240,0: RETURN
7000  SET 108,75: DRAW 2,1: DRAW 0,24: DRAW  - 2,1: RETURN
7001  SET 106,74: DRAW 2,1: DRAW 0,26: DRAW  - 2,1: RETURN
7002  SET 102,71: DRAW 4,3: DRAW 0,28: DRAW  - 4,3: RETURN
7003  SET 94,65: DRAW 8,6: DRAW 0,34: DRAW  - 8,6: RETURN
7004  SET 82,57: DRAW 12,8: DRAW 0,46: DRAW  - 12,8: RETURN
7005  SET 64,45: DRAW 18,12: DRAW 0,62: DRAW  - 18,12: RETURN
7006  SET 40,29: DRAW 24,16: DRAW 0,86: DRAW  - 24,16: RETURN
7007  SET 8,7: DRAW 32,22: DRAW 0,118: DRAW  - 32,22: RETURN
7008  SET 0,1: DRAW 8,6: DRAW 0,162: DRAW  - 8,6: RETURN
7500  SET 108,76: DRAW 2,0: DRAW 0,24: DRAW  - 2,0: RETURN
7501  SET 106,75: DRAW 2,0: DRAW 0,26: DRAW  - 2,0: RETURN
7502  SET 102,74: DRAW 4,0: DRAW 0,28: DRAW  - 4,0: RETURN
7503  SET 94,71: DRAW 8,0: DRAW 0,34: DRAW  - 8,0: RETURN
7504  SET 82,65: DRAW 12,0: DRAW 0,46: DRAW  - 12,0: RETURN
7505  SET 64,57: DRAW 18,0: DRAW 0,62: DRAW  - 18,0: RETURN
7506  SET 40,45: DRAW 24,0: DRAW 0,86: DRAW  - 24,0: RETURN
7507  SET 8,29: DRAW 32,0: DRAW 0,118: DRAW  - 32,0: RETURN
7508  SET 0,7: DRAW 8,0: DRAW 0,162: DRAW  - 8,0: RETURN
8000  SET 148,75: DRAW  - 2,1: DRAW 0,24: DRAW 2,1: RETURN
8001  SET 150,74: DRAW  - 2,1: DRAW 0,26: DRAW 2,1: RETURN
8002  SET 154,71: DRAW  - 4,3: DRAW 0,28: DRAW 4,3: RETURN
8003  SET 162,65: DRAW  - 8,6: DRAW 0,34: DRAW 8,6: RETURN
8004  SET 174,57: DRAW  - 12,8: DRAW 0,46: DRAW 12,8: RETURN
8005  SET 192,45: DRAW  - 18,12: DRAW 0,62: DRAW 18,12: RETURN
8006  SET 216,29: DRAW  - 24,16: DRAW 0,86: DRAW 24,16: RETURN
8007  SET 248,7: DRAW  - 32,22: DRAW 0,118: DRAW 32,22: RETURN
8008  SET 255,1: DRAW  - 8,6: DRAW 0,162: DRAW 8,6: RETURN
8500  SET 148,76: DRAW  - 2,0: DRAW 0,24: DRAW 2,0: RETURN
8501  SET 150,75: DRAW  - 2,0: DRAW 0,26: DRAW 2,0: RETURN
8502  SET 154,74: DRAW  - 4,0: DRAW 0,28: DRAW 4,0: RETURN
8503  SET 162,71: DRAW  - 8,0: DRAW 0,34: DRAW 8,0: RETURN
8504  SET 174,65: DRAW  - 12,0: DRAW 0,46: DRAW 12,0: RETURN
8505  SET 192,57: DRAW  - 18,0: DRAW 0,62: DRAW 18,0: RETURN
8506  SET 216,45: DRAW  - 24,0: DRAW 0,86: DRAW 24,0: RETURN
8507  SET 248,29: DRAW  - 32,0: DRAW 0,118: DRAW 32,0: RETURN
8508  SET 255,7: DRAW  - 8,0: DRAW 0,162: DRAW 8,0: RETURN
9000  RESTORE 9100: FOR II = 1 TO 9:H(II,1) = 1:H(II,10) = 1: FOR J = 2 TO 9: READ H(II,J): NEXT J,II
9010  FOR II = 1 TO 9:V(1,II) = 1:V(10,II) = 1: FOR J = 2 TO 9: READ V(J,II): NEXT J,II
9020  RETURN
9100  DATA 1,1,1,0,0,0,0,1
9101  DATA 0,0,1,0,0,1,0,1
9102  DATA 1,1,0,0,0,0,1,1
9103  DATA 0,0,1,1,0,0,1,0
9104  DATA 1,1,1,0,0,1,1,0
9105  DATA 1,0,0,0,0,0,0,1
9106  DATA 1,1,1,0,1,0,0,1
9107  DATA 1,1,1,0,0,1,1,0
9108  DATA 1,0,0,0,0,0,0,0
9200  DATA 0,0,0,0,0,0,0,0
9201  DATA 1,1,1,1,0,1,0,0
9202  DATA 0,0,0,0,0,0,0,1
9203  DATA 0,1,0,0,1,0,0,0
9204  DATA 1,1,0,1,1,1,1,1
9205  DATA 1,1,1,1,1,1,0,1
9206  DATA 0,0,0,0,0,0,1,0
9207  DATA 1,1,0,0,1,1,0,0
9208  DATA 0,0,0,1,0,0,0,1
9990  REM
9991  POKE 277,22:POKE 278,0
9992 FOR J = 1 TO 100:NORMAL:IF J AND 1 THEN INVERSE
9993 A=USR("   MUITO BEM! VOCE CONSEGUIU!   "):NEXT
9994  POKE 277,23:INVERSE:A=USR("     QUER TENTAR OUTRA VEZ?     "): NORMAL:POKE 284,0
9995 A$ =  CHR$ ( PEEK (284)): IF A$ = "S" THEN  RUN 100
9996  IF A$ <  > "N" THEN 9995
9997  TEXT : END
65000  REM INSTALADOR
65010  TEXT : HOME : PRINT "INSTALANDO HGRPRINT. AGUARDE..."
65020  RESTORE 65000
65030  READ E: IF E =  - 1 THEN  RETURN
65040  READ B: IF B =  - 1 THEN 65030
65050  POKE E,B:E = E + 1: GOTO 65040
65100  REM CONFIGURA USR()
65110  DATA 771
65120  DATA 195,176,60,-1
65130  REM ROTINA DE IMPRESSAO EM HGR
65140  DATA 15536
65150  DATA 205,161,232,200,71,35,35,78,35,102,105,229,33,21,1,86,35,94,33,,128,25,235,225,205,134,200,126,214,32,56,41
65160  DATA 229,213,197,38,,111,41,41,41,1,,61,9,58,82,3,214,1,159,47,79,6,8,126,169,18,35,123,198,32,95,122
65170  DATA 206,,87,16,242,193,209,225,19,35,16,207,195,121,200,-1
65180  REM TABELA DE CARACTERES
65190  DATA 15616
65200  DATA ,,,,,,,,8,8,8,8,8,,8,,20,20,20,,,,,,20,20,62,20,20,62,20,20
65210  DATA 8,28,32,28,2,60,8,8,24,36,24,62,12,18,12,,,12,16,16,26,36,31,,8,8,8,,,,,
65220  DATA 8,8,16,16,16,8,8,,16,16,8,8,8,16,16,,8,62,8,20,,,,,,8,8,62,8,8,,
65230  DATA ,,,,,,8,16,,,,62,,,,,,,,,,,8,,2,4,4,8,16,16,32,
65240  DATA 28,34,34,34,34,34,28,,24,40,8,8,8,8,62,,28,34,2,4,8,16,62,,28,34,2,12,2,34,28,
65250  DATA 4,12,20,36,62,4,14,,62,32,32,60,2,34,28,,12,16,32,60,34,34,28,,62,34,2,4,4,8,8,
65260  DATA 28,34,34,28,34,34,28,,28,34,34,30,2,4,24,,,,8,,,8,,,,,8,,,8,24,
65270  DATA ,2,12,48,12,2,,,,,62,,62,,,,,32,24,6,24,32,,,28,34,2,4,8,,8,
65280  DATA 12,18,38,42,42,38,16,12,56,8,20,20,62,34,119,,124,34,34,60,34,34,124,,30,34,64,64,64,34,28,
65290  DATA 120,36,34,34,34,36,120,,126,34,40,56,40,34,126,,126,34,40,56,40,32,112,,30,34,64,64,79,34,28,
65300  DATA 119,34,34,62,34,34,119,,62,8,8,8,8,8,62,,7,2,2,2,34,34,28,,119,34,36,56,36,34,119,
65310  DATA 112,32,32,32,34,34,126,,99,34,54,42,42,34,119,,103,50,50,42,38,38,114,,28,34,65,65,65,34,28,
65320  DATA 124,34,34,60,32,32,112,,28,34,65,65,34,28,13,18,124,34,34,34,60,34,113,,30,34,32,28,2,34,60,
65330  DATA 127,73,8,8,8,8,28,,119,34,34,34,34,34,28,,119,34,34,34,20,20,8,,119,34,42,42,28,20,20,
65340  DATA 119,34,20,8,20,34,119,,119,34,20,8,8,8,28,,62,34,4,8,16,34,62,,12,8,8,8,8,8,12,
65350  DATA 32,16,16,8,4,4,2,,24,8,8,8,8,8,24,,,8,20,,,,,,,,,,,,,255
65535  DATA -1,-1
