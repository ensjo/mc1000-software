0  CLEAR 512,15535: GOSUB 65000
10  HGR
15 SP$ = "                                ":V$ =  CHR$ (113):V$ = V$ + V$ + V$ + V$ + V$
20 W =  RND ( - ( PEEK (263) +  PEEK (264) * 256) * 2 ^  - 24): REM RANDOMIZE
30  DIM C(52): FOR N = 1 TO 52:C(N) = N: NEXT N
40  DIM A(13)
50  RESTORE 60: FOR N = 1 TO 13: READ A(N): NEXT N
60  DATA 1,6,7,8,9,24,26,30,41,46,1,1,1
70 CC = 1:CP = 100
80  GOSUB 5000
85  DIM S(2),O(2),W(2)
90 BET = 0
100  FOR W = 1 TO 2:S(W) = 0:O(W) = 0:W(W) = 0: NEXT W
500 Y = 0:X = 1:TF = 0:AF = 0:PF = 0:FF = 0
520  FOR U = 1 TO 2
525 Z = C(CC)
530  GOSUB 5500: GOSUB 6000: GOSUB 6500
535  IF CC = 52 THEN CC = 0
540 O(U) = C(CC + 1)
550 X = X + 6
560  POKE 277,21: POKE 278,0:W =  USR ("VOCE TEM" +  STR$ (CP) + " FICHAS.    ")
570  IF U = 1 THEN  POKE 277,23:W =  USR ("QUAL E A SUA APOSTA? "): POKE 278,21: GOSUB 10000:AM =  VAL (IP$): POKE 278,0:W =  USR (SP$): IF AM > CP OR AM < 1 THEN 570
590  IF U = 1 THEN CP = CP - AM:BET = AM
595  GOSUB 7000: GOSUB 7000: NEXT U
622  IF S(2) = 21 THEN PF = 1: POKE 277,4: POKE 278,18: INVERSE :W =  USR (" NATURAL "): NORMAL : GOTO 2500
700  IF (S(1) < 16 AND (S(2) < 16 OR S(2) > 21) OR TF = 1 OR CP < AM) THEN 705
702  POKE 277,23: POKE 278,0:W =  USR ("COMPRA, PEDE OU SATISFEITO?"): CALL 49158:W =  USR (SP$):D$ =  CHR$ ( PEEK (284)): IF D$ <  > "C" AND D$ <  > "P" AND D$ <  > "S" THEN 702
703  GOTO 715
705  IF (S(1) > 21 OR CP < AM OR TF = 1) THEN 710
706  POKE 277,23: POKE 278,0:W =  USR ("COMPRA OU PEDE?"): CALL 49158:W =  USR (SP$):D$ =  CHR$ ( PEEK (284)): IF D$ <  > "C" AND D$ <  > "P" THEN 706
708  GOTO 720
710  IF (S(1) < 16 AND (S(2) < 16 OR S(2) > 21)) THEN 770
711  POKE 277,23: POKE 278,0:W =  USR ("PEDE OU SATISFEITO?"): CALL 49158:W =  USR (SP$):D$ =  CHR$ ( PEEK (284)): IF D$ <  > "P" AND D$ <  > "S" THEN 711
715  IF D$ = "S" THEN 2500
720  IF  LEN (D$) = 0 THEN 700
725  IF  LEFT$ (D$,1) <  > "C" THEN TF = 1: GOTO 905
760 BET = BET + AM:CP = CP - AM
770  POKE 277,21: POKE 278,0:W =  USR (SP$) AND  USR ("VOCE TEM" +  STR$ (CP) + " FICHAS.")
905 Z = C(CC)
910  GOSUB 5500: GOSUB 6000: GOSUB 7000
920 X = X + 6
921  IF S(1) > 21 THEN 2000
925  IF X = 31 AND S(1) < 22 THEN  POKE 277,22: POKE 278,0:W =  USR (SP$): INVERSE :W =  USR (" MAO DE CINCO! "):FF = 1: GOTO 2500
930  GOTO 700
2000  IF CP = 0 THEN  POKE 277,21: POKE 278,0:W =  USR (SP$) AND  USR ("VOCE PERDEU TODAS AS FICHAS!"): GOTO 8000
2010  IF CP >  = 1000 THEN  POKE 277,21: POKE 278,0:W =  USR (SP$) AND  USR ("PARABENS! VOCE QUEBROU A BANCA!"): GOTO 8000
2020  POKE 277,23: POKE 278,0:W =  USR (SP$) AND  USR ("PRESSIONE 'S' PARA OUTRA MAO.")
2025  POKE 284,0
2030  IF  CHR$ ( PEEK (284)) <  > "S" THEN 2030
2040  HGR : GOTO 90
2500  FOR W = 1 TO 1000: NEXT W
2510 DPF = 0:AF = 0:X = 1:Y = 10
2520  FOR J = 1 TO 2
2530 Z = O(J): GOSUB 5500
2540  IF VA > 10 THEN VA = 10
2545  FOR K = 1 TO 2:W(K) = W(K) + VA: NEXT K
2546  IF VA = 1 AND AF = 0 THEN W(2) = W(2) + 10:AF = 1
2550 X = X + 6: NEXT J
2560  IF W(2) = 21 THEN  POKE 277,14: POKE 278,18: INVERSE :W =  USR (" NATURAL! "): NORMAL : POKE 277,15: POKE 278,16:W =  USR (" A BANCA GANHA. "):DPF = 1: GOTO 2000
2600  IF PF = 1 THEN 2720
2610  FOR W = 1 TO 1500: NEXT W
2630  IF W(1) > 21 THEN  POKE 277,21: POKE 278,0:S$ = " A BANCA ESTOURA! ": GOTO 2740
2635  IF W(2) > 21 THEN W(2) = W(1)
2640  IF W(2) < 16 THEN 2800
2650  IF FF = 1 THEN 2800
2660 PR = (W(2) - 8) / 13
2670  IF PR <  RND (1) THEN 2800
2700  IF W(2) > 21 THEN W(2) = W(1)
2710  IF W(2) = 21 THEN  POKE 277,20: POKE 278,0:W =  USR (SP$) AND  USR (" A BANCA PAGA SOMENTE NATURAIS  "): POKE 277,21:W =  USR (SP$) AND  USR (" E MAOS DE CINCO."): GOTO 2000
2720  POKE 277,21: POKE 278,0:W =  USR (SP$):S$ = " A BANCA OBTEVE" +  STR$ (W(2))
2725  IF S(2) > 21 THEN S(2) = S(1)
2730  IF W(2) >  = S(2) THEN S$ = S$ + " E GANHOU! ":W =  USR (S$): GOTO 2000
2740 S$ = S$ + "- VOCE GANHOU. ":W =  USR (S$):CP = CP + BET * 2: GOTO 2000
2800 Z = C(CC): GOSUB 5500
2805  IF VA > 10 THEN VA = 10
2810  FOR K = 1 TO 2:W(K) = W(K) + VA: NEXT K
2820  IF VA = 1 AND AF = 0 THEN W(2) = W(2) + 10:AF = 1
2822  IF W(1) < 22 AND X = 25 THEN  POKE 277,21: POKE 278,0:W =  USR (SP$): INVERSE :W =  USR (" MAO DE CINCO! "): NORMAL : GOTO 2000
2825  GOSUB 7000
2830 X = X + 6: GOTO 2610
5000  HGR : POKE 277,10: POKE 278,3:W =  USR ("EMBARALHANDO AS CARTAS...")
5010  FOR N = 1 TO 100
5020 X =  INT ( RND (1) * 52) + 1
5030 Y =  INT ( RND (1) * 52) + 1
5040 Z = C(X):C(X) = C(Y):C(Y) = Z
5050  NEXT N
5060  HGR : RETURN
5500  INVERSE : POKE 278,X: FOR N = Y TO Y + 8: POKE 277,N:W =  USR ("     "): NEXT N
5510 ST =  INT ((Z - 1) / 13)
5520 CH$ =  CHR$ (96 + ST)
5530 VA = Z - 13 * ST
5560 AC$ =  CHR$ (95 + 4 + VA)
5600  POKE 277,Y: POKE 278,X:W =  USR (AC$): POKE 277,Y + 8: POKE 278,X + 4:W =  USR (AC$)
5610 AV = A(VA)
5611  IF AV AND 1 THEN  POKE 277,Y + 4: POKE 278,X + 2:W =  USR (CH$)
5612  IF AV AND 2 THEN  POKE 277,Y + 2: POKE 278,X + 2:W =  USR (CH$)
5613  IF AV AND 4 THEN  POKE 277,Y + 6: POKE 278,X + 2:W =  USR (CH$)
5614  IF AV AND 8 THEN  POKE 277,Y + 1: POKE 278,X + 1:W =  USR (CH$): POKE 278,X + 3:W =  USR (CH$): POKE 277,Y + 7:W =  USR (CH$): POKE 278,X + 1:W =  USR (CH$)
5615  IF AV AND 16 THEN  POKE 277,Y + 4: POKE 278,X + 1:W =  USR (CH$): POKE 278,X + 3:W =  USR (CH$)
5616  IF AV AND 32 THEN  POKE 277,Y + 3: POKE 278,X + 1:W =  USR (CH$): POKE 278,X + 3:W =  USR (CH$): POKE 277,Y + 5:W =  USR (CH$): POKE 278,X + 1:W =  USR (CH$)
5890  NORMAL
5900  RETURN
6000  IF VA > 10 THEN VA = 10
6010 S(1) = S(1) + VA:S(2) = S(2) + VA
6020  IF VA = 1 AND AF = 0 THEN S(2) = S(2) + 10:AF = 1
6030  IF S(1) > 21 THEN  POKE 277,20: POKE 278,0: INVERSE :W =  USR ("         VOCE QUEBROU!          "): NORMAL :DPF = 0: RETURN
6040  POKE 277,20: POKE 278,0:W =  USR (SP$)
6050 S$ = "SEU SCORE E'" +  STR$ (S(1)): IF S(2) <  > S(1) AND S(2) < 22 THEN S$ = S$ + " OU" +  STR$ (S(2))
6055 W =  USR (S$ + ".")
6060  RETURN
6500  POKE 278,X: FOR N = 10 TO 18
6510  POKE 277,N:W =  USR (V$)
6520  NEXT N
6530  RETURN
7000 CC = CC + 1: IF CC = 53 THEN CC = 1
7010  RETURN
8000  POKE 277,23: POKE 278,0:W =  USR (SP$):W =  USR ("JOGAR DE NOVO (S/N)?"): POKE 284,0
8010 IP$ =  CHR$ ( PEEK (284)): IF IP$ = "S" THEN  RUN 10
8020  IF IP$ = "N" THEN  TEXT : END
8030  GOTO 8010
10000  REM HGRINPUT
10010 IP$ = ""
10020  POKE 284,0
10030  INVERSE :W =  USR (" "): NORMAL :CH =  PEEK (284):W =  USR (" "): IF CH = 0 THEN 10030
10040  IF CH = 13 THEN  RETURN
10050  IF (CH = 7 OR CH = 127) AND IP$ <  > "" THEN IP$ =  LEFT$ (IP$, LEN (IP$) - 1): POKE 278, PEEK (278) - 1: GOTO 10020
10060  IF CH > 31 AND CH <  > 127 THEN IP$ = IP$ +  CHR$ (CH):W =  USR ( CHR$ (CH)): POKE 278, PEEK (278) + 1
10070  GOTO 10020
64999  END
65000  REM INSTALADOR
65010  TEXT : PRINT "INSTALANDO HGRPRINT. AGUARDE..."
65020  RESTORE 65000
65030  READ E: IF E =  - 1 THEN  RETURN
65040  READ B: IF B =  - 1 THEN 65030
65050  POKE E,B:E = E + 1: GOTO 65040
65100  REM CONFIGURA USR()
65110  DATA 771
65120  DATA 195,176,60,-1
65130  REM ROTINA DE IMPRESSAO EM HGR
65140  DATA 15536
65150  DATA 205,161,232,200,71,35,35,78,35,102,105,229,33,21,1,86,35,94,33,,128,25,235,225,205,134,200,126,214,32,56,41
65160  DATA 229,213,197,38,,111,41,41,41,1,,61,9,58,82,3,214,1,159,47,79,6,8,126,169,18,35,123,198,32,95,122
65170  DATA 206,,87,16,242,193,209,225,19,35,16,207,195,121,200,-1
65180  REM TABELA DE CARACTERES
65190  DATA 15616
65200  DATA ,,,,,,,,16,16,16,16,16,,16,,40,40,40,,,,,,40,40,124,40,124,40,40,
65210  DATA 16,60,80,56,20,120,16,,96,100,8,16,32,76,12,,32,80,80,32,84,72,52,,16,16,16,,,,,
65220  DATA 8,16,32,32,32,16,8,,32,16,8,8,8,16,32,,16,84,56,16,56,84,16,,,16,16,124,16,16,,
65230  DATA ,,,,16,16,32,,,,,124,,,,,,,,,,,16,,,4,8,16,32,64,,
65240  DATA 56,68,76,84,100,68,56,,16,48,16,16,16,16,56,,56,68,4,24,32,64,124,,124,4,8,24,4,68,56,
65250  DATA 8,24,40,72,124,8,8,,124,64,120,4,4,68,56,,28,32,64,120,68,68,56,,124,4,8,16,32,32,32,
65260  DATA 56,68,68,56,68,68,56,,56,68,68,60,4,8,112,,,,16,,16,,,,,,16,,16,16,32,
65270  DATA 8,16,32,64,32,16,8,,,,124,,124,,,,32,16,8,4,8,16,32,,56,68,8,16,16,,16,
65280  DATA 56,68,84,92,88,64,60,,16,40,68,68,124,68,68,,120,68,68,120,68,68,120,,56,68,64,64,64,68,56,
65290  DATA 120,68,68,68,68,68,120,,124,64,64,120,64,64,124,,124,64,64,120,64,64,64,,60,64,64,64,76,68,60,
65300  DATA 68,68,68,124,68,68,68,,56,16,16,16,16,16,56,,4,4,4,4,4,68,56,,68,72,80,96,80,72,68,
65310  DATA 64,64,64,64,64,64,124,,68,108,84,84,68,68,68,,68,68,100,84,76,68,68,,56,68,68,68,68,68,56,
65320  DATA 120,68,68,120,64,64,64,,56,68,68,68,84,72,52,,120,68,68,120,80,72,68,,56,68,64,56,4,68,56,
65330  DATA 124,16,16,16,16,16,16,,68,68,68,68,68,68,56,,68,68,68,68,68,40,16,,68,68,68,84,84,108,68,
65340  DATA 68,68,40,16,40,68,68,,68,68,40,16,16,16,16,,124,4,8,16,32,64,124,,124,96,96,96,96,96,124,
65350  DATA ,64,32,16,8,4,,,124,12,12,12,12,12,124,,,,16,40,68,,,,,,,,,,,127
65360  DATA 0,54,127,127,127,62,28,8,0,8,28,62,127,62,28,8,8,28,62,127,127,62,8,28,8,28,28,107,127,107,8,28
65370  DATA 0,8,20,34,34,62,34,34,0,28,34,2,4,24,32,62
65380  DATA 0,28,34,2,12,2,34,28,0,4,12,20,36,62,4,14
65390  DATA 0,62,32,32,60,2,34,28,0,28,34,32,60,34,34,28
65400  DATA 0,62,34,2,4,8,16,16,0,28,34,34,28,34,34,28
65410  DATA 0,28,34,34,30,2,34,28,0,76,82,82,82,82,82,76
65420  DATA 0,14,4,4,4,4,36,24,0,28,34,34,34,58,102,30
65430  DATA 0,118,36,40,48,40,36,118,85,85,85,85,85,85,85,85
65440  DATA -1,-1
