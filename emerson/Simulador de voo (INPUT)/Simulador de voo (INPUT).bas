0  REM--------10--------20--------30--------40--------50--------60--------70
1  DATA 33,230,3,34,33,1
2  DATA 62,195,50,32,1,201,221,229,221,33,255,255,221,35,221,57
3  DATA 62,93,221,190,16,32,18,62,221,221,190,17,32,11,229,33
4  DATA 12,4,221,117,10,221,116,11,225,221,225,201,193,209,51,51
5  DATA 50,29,1,183,58,27,1,50,28,1,196,223,221,195,97,221
6  RESTORE 1: FOR I = 0 TO 69: READ B: POKE 986 + I,B: NEXT I
7  CALL 986
10  HOME : PRINT "INICIALIZANDO...": CLEAR 512,15535: GOSUB 65000
30 I =  RND ( - ( PEEK (263) +  PEEK (264) * 256) * 2 ^  - 24): REM RANDOMIZE
740  GOTO 5000
800 RA = AD * C:VX = VV *  SIN (RA)
810 VY = VV *  COS (RA): RETURN
1000 PZ = PZ + GZ:PY = PY + GY:PX = PX + GX
1020 VV = VV + 16 * (TC * 30 - VV - 8 * PT) / VV
1030  IF ST = 1 THEN  FOR I = 1 TO 8: UNPLOT 90,I TO 230,I: NEXT I:ST = 0: GOTO 1050
1040  IF VV < 30 THEN  GOSUB 1500
1050 AD = AD + RL: IF AD < 0 THEN AD = AD + 360
1060  IF AD > 359 THEN AD = AD - 360
1070 VZ = VV *  SIN (PT * C) - 10 + VV / 15
1080 GZ = VZ:GY = VY + WY:GX = VX + WX
1090  IF VY = 0 THEN GD =  - PI / 2: GOTO 1110
1100 GD =  -  ATN (VX / VY) / C
1110  GOSUB 800
1120  RETURN
1500 ST = 1: POKE 278,12: POKE 277,0
1510 I =  USR ("MERGULHO")
1520  TEMPO 255,3,1: FOR I = 1 TO 2: RESTORE 1525: FOR K = 1 TO 6: READ N: SOUND N,20,1: NEXT K,I: SOUND 0,0,1
1525  DATA 89,87,85,84,82,80
1530 RL =  INT ( RND (1) * 21) - 9:PT =  - 21 -  INT ( RND (1) * 5)
1540  RETURN
2000  REM COLOR15
2005  UNPLOT 35,128 TO 35 + 15 *  SIN (V1 * PI / 200),128 - 15 *  COS (V1 * PI / 200)
2010  PLOT 35,128 TO 35 + 15 *  SIN (VV * PI / 200),128 - 15 *  COS (VV * PI / 200)
2015  UNPLOT 155,128 TO 155 + 10 *  SIN (T1 * PI / 5),128 - 10 *  COS (T1 * PI / 5)
2020 TN = PZ / 1000:UN = PZ - 1000 *  INT (TN): PLOT 155,128 TO 155 + 10 *  SIN (TN * PI / 5),128 - 10 *  COS (TN * PI / 5)
2025  UNPLOT 155,128 TO 155 + 15 *  SIN (U1 * PI / 500),128 - 15 *  COS (U1 * PI / 500)
2030  PLOT 155,128 TO 155 + 15 *  SIN (UN * PI / 500),128 - 15 *  COS (UN * PI / 500)
2035  UNPLOT 215,128 TO 215 + 15 *  SIN (T2 * PI / 5),128 - 15 *  COS (T2 * PI / 5)
2040  PLOT 215,128 TO 215 + 15 *  SIN (TC * PI / 5),128 - 15 *  COS (TC * PI / 5)
2050  POKE 278,2: POKE 277,22:I =  USR ( STR$ ( ABS ( INT (AD))) + "  ")
2060  IF PY = 0 THEN RB = 0: GOTO 2070
2062 RB =  ATN (PX / PY) / C
2065  IF PY > 0 THEN RB = RB + 180
2070  IF RB < 0 THEN RB = RB + 360
2080  POKE 278,10:I =  USR ( STR$ ( INT (RB)) + "  "): POKE 278,17:I =  USR ( STR$ ( INT (PX)) + "  ")
2090  POKE 278,24:I =  USR ( STR$ ( INT ( SQR (PY * PY + PX * PX))) + " ")
2100 YC = 128 + PT:X1 = 80:X2 = 110:Y1 = YC + 17 *  TAN (RL * 2 * C):Y2 = YC - 17 *  TAN (RL * 2 * C)
2110  IF (YC < 113 OR YC > 143) AND RL = 0 THEN 2320
2120  IF Y1 < 113 THEN X1 = 95 - (95 - X1) * (105 - YC) / (Y1 - YC):Y1 = 113: GOTO 2140
2130  IF Y1 > 143 THEN X1 = 95 - (95 - X1) * (135 - YC) / (Y1 - YC):Y1 = 143
2140  IF Y2 < 113 THEN X2 = 95 - (95 - X2) * (105 - YC) / (Y2 - YC):Y2 = 113: GOTO 2160
2150  IF Y2 > 143 THEN X2 = 95 - (95 - X2) * (135 - YC) / (Y2 - YC):Y2 = 143
2160  IF X1 < 80 OR X2 > 110 THEN 2180
2165  SET 81,128: DRAW 9,0: DRAW 5,5: DRAW 5, - 5: DRAW 9,0
2170  UNPLOT X5,Y5 TO X6,Y6: PLOT X1,Y1 TO X2,Y2:X5 = X1:Y5 = Y1:X6 = X2:Y6 = Y2
2180  IF X7 - R > 10 AND X7 + R < 245 AND Y7 > 0 AND Y7 < 80 THEN R5 = 5 * R: SET X7 - R,Y7: UNDRAW 0,R5: UNDRAW R,R5: UNDRAW R, - R5: UNDRAW 0, - R5
2190  IF RL = RR AND PP = PT THEN 2290
2200  IF HF = 1 THEN  UNPLOT X3,Y3 TO X4,Y4
2210 HF = 0:YC = 33 + PT * 4:X3 = 16:X4 = 239:Y3 = YC + 118 *  TAN (RL * 2 * C):Y4 = YC - 118 *  TAN (RL * 2 * C)
2220  IF (YC < 10 OR YC > 79) AND RL = 0 THEN 2290
2230  IF Y3 < 1 THEN X3 = 128 - (128 - X3) * (1 - YC) / (Y3 - YC):Y3 = 1: GOTO 2250
2240  IF Y3 > 79 THEN X3 = 128 - (128 - X3) * (79 - YC) / (Y3 - YC):Y3 = 79
2250  IF Y4 < 1 THEN X4 = 128 - (128 - X4) * (1 - YC) / (Y4 - YC):Y4 = 1: GOTO 2270
2260  IF Y4 > 79 THEN X4 = 128 - (128 - X4) * (79 - YC) / (Y4 - YC):Y4 = 79
2270  IF X3 < 16 OR X4 > 239 THEN 2290
2280 HF = 1: PLOT X3,Y3 TO X4,Y4
2290 WB = AD: IF AD > 180 THEN WB = WB - 360
2300  IF RB > 180 THEN WB = WB + 360 - RB: GOTO 2310
2305 WB = WB - RB
2310  IF  ABS (WB) > 60 AND  ABS (PY) > 1000 THEN 2370
2320 AN = 118 / (60 *  SQR ((X3 - X4) * (X3 - X4) + (Y3 - Y4) * (Y3 - Y4))):X7 = (X3 + X4) / 2 +  SGN (X3 - X4) + WB * AN * (X3 - X4)
2330 Y7 = (Y3 + Y4) / 2 + 2 + WB * AN * (Y3 - Y4): IF X7 < 16 OR X7 > 239 OR Y7 < 1 OR Y7 > 79 THEN 2370
2340  IF  ABS (PY) < 1000 THEN R = 8 - Y7 / 10: GOTO 2350
2345 R = 4000 /  ABS (PY): IF R * 10 + Y7 > 80 THEN R = 8 - Y7 / 10
2350  IF Y7 < 1 OR Y7 > 79 OR X7 - R < 16 OR X7 + R > 239 THEN 2370
2360 R5 = 5 * R: SET X7 - R,Y7: DRAW 0,R5: DRAW R,R5: DRAW R, - R5: DRAW 0, - R5
2370 V1 = VV:U1 = UN:T1 = TN:T2 = TC
2380 RR = RL:PP = PT: RETURN
3000  IF  PEEK (285) = 0 THEN  RETURN
3010 K$ =  CHR$ ( PEEK (284))
3020  IF K$ = "Q" THEN T2 = TC:TC = TC + .2 *  ABS (TC < 8.8): RETURN
3030  IF K$ = "A" THEN T2 = TC:TC = TC - .2 *  ABS (TC > .2): RETURN
3040  IF K$ = "Z" THEN RL = RL - 3 *  ABS (RL >  - 30): RETURN
3050  IF K$ = "X" THEN RL = RL + 3 *  ABS (RL < 30): RETURN
3060  IF K$ = "P" THEN PT = PT + 3: RETURN
3070  IF K$ = "L" THEN PT = PT - 3: RETURN
3080  RETURN
4000  REM DESENHA CIRCULO
4010 XX = 0:YY =  INT (RC):P =  INT (3 - 2 * RC)
4020  IF XX > YY THEN  RETURN
4030  PLOT X + XX,Y + YY
4040  PLOT X - XX,Y + YY
4050  PLOT X + XX,Y - YY
4060  PLOT X - XX,Y - YY
4070  PLOT X + YY,Y + XX
4080  PLOT X - YY,Y + XX
4090  PLOT X + YY,Y - XX
4100  PLOT X - YY,Y - XX
4110  IF P < 0 THEN P = P + 4 * XX + 6: GOTO 4130
4120 P = P + 4 * (XX - YY) + 10:YY = YY - 1
4130 XX = XX + 1: GOTO 4020
5000 PP =  - 1:RR =  - 1
5010 PI = 4 *  ATN (1):C = PI / 180:PY =  - 20000:PZ = 2000:VV = 150
5020  TEXT : HOME : INPUT "VELOCIDADE DO VENTO (1-50 M/S)";X0
5025  IF X0 > 50 OR X0 < 1 THEN 5020
5030  INPUT "DIRECAO DO VENTO (0-359 GRAUS)";X1
5035  IF X1 > 359 OR X1 < 0 THEN 5030
5040 X0 = X0 / 3
5050  PRINT : PRINT "VELOCIDADE DO VENTO:"; INT (3 * X0);"M/S": PRINT "DIRECAO DO VENTO:";X1;"GRAUS"
5060 WY = X0 *  COS (X1 * C):WX =  - X0 *  SIN (X1 * C)
5070  FOR I = 1 TO 1000: NEXT
5080 GZ = VZ:GY = VY + WY:GX = VX + WX
5090 TC = 5
5100 RT = 3:TP = 5:WR = 50
5110  HGR : PLOT 10,0 TO 245,0 TO 245,80 TO 10,80 TO 10,0
5120  FOR K = 0 TO 3:X = 35 + K * 60:Y = 128:RC = 25: GOSUB 4000: NEXT
5140 X = 35:Y = 128: GOSUB 7000:X = 155: GOSUB 7000:X = 215: GOSUB 7000
5150  POKE 278,1: POKE 277,11:I =  USR ("AIRSPEED"): POKE 278,10:I =  USR ("HORIZ")
5160  POKE 278,16:I =  USR ("ALTITUDE"): POKE 278,26:I =  USR ("RPM")
5170  POKE 278,1: POKE 277,20:I =  USR ("BEARING"): POKE 278,9:I =  USR ("RUNWAY")
5180  POKE 278,17:I =  USR ("DRIFT"): POKE 278,23:I =  USR ("DISTANCE")
5190  SET 81,128: DRAW 9,0: DRAW 5,5: DRAW 5, - 5: DRAW 9,0
5500  GOSUB 3000: GOSUB 1000
5510  IF PZ <  = 0 THEN 6000
5520  GOSUB 2000
5530  GOTO 5500
6000  IF  ABS (RL) > RT OR PT > TP OR PT < 0 OR VV > 80 THEN 6100
6010  IF  ABS (PX) > WR OR  ABS (PY) > 1000 THEN 6200
6020  TEXT : HOME
6030  PRINT "PARABENS!": PRINT "ATERRISSAGEM BEM SUCEDIDA.": GOTO 6500
6100  PLOT 0,0 TO  RND (1) * 128 + 64, RND (1) * 96 + 49 TO 255,191: PLOT 255,0 TO  RND (1) * 128 + 64, RND (1) * 96 + 49 TO 0,191
6110  FOR K = 1 TO 1000: NEXT
6120  TEXT : HOME : POKE 245,3: PRINT "LAMENTAMOS INFORMAR QUE O VOO"
6130  PRINT "PJ26 SOFREU UM GRAVE ACIDENTE."
6140  PRINT "NAO HA SOBREVIVENTES.": GOTO 6500
6200  TEXT : HOME
6210  PRINT "VOCE POUSOU FORA DA PISTA."
6220  IF VV < 40 THEN  PRINT "COMO SUA VELOCIDADE ERA BAIXA,": PRINT "QUASE NADA ACONTECEU.": GOTO 6500
6230  IF VV < 80 THEN  PRINT "ENTRE MORTOS E FERIDOS,": PRINT "SALVARAM-SE TODOS.": GOTO 6500
6240  POKE 245,3: PRINT "NINGUEM SOBREVIVE A UM POUSO": PRINT "NESTA VELOCIDADE."
6500  PRINT : PRINT "VALORES RELATIVOS AO POUSO:"
6510  PRINT : PRINT "VELOCIDADE DO AR="; INT (VV);"M/S": PRINT "DISTANCIA="; INT ( SQR (PY * PY + PX * PX));"M": PRINT "INCLINACAO FRONTAL=";PT
6520  PRINT "INCLINACAO LATERAL=";RL: PRINT "ROTACAO DO MOTOR="; INT (TC * 1000);"RPM"
6530  PRINT "DESVIO DO EIXO DA PISTA="; INT (PX);"M": PRINT "DIRECAO=";AD;"GRAUS"
6540  PRINT : PRINT "QUER VOAR NOVAMENTE (S/N)?";
6550 A$ = "": IF  PEEK (285) THEN A$ =  CHR$ ( PEEK (284))
6555  IF A$ <  > "S" AND A$ <  > "N" THEN 6550
6560  POKE 245,1: IF A$ = "N" THEN  END
6570  RUN
7000  FOR K = 0 TO 9: PLOT X + 21 *  SIN (K * PI / 5),Y - 21 *  COS (K * PI / 5) TO X + 19 *  SIN (K * PI / 5),Y - 19 *  COS (K * PI / 5): NEXT : RETURN
65000  REM INSTALADOR
65010  PRINT "INSTALANDO HGRPRINT. AGUARDE..."
65020  RESTORE 65000
65030  READ E: IF E =  - 1 THEN  RETURN
65040  READ B: IF B =  - 1 THEN 65030
65050  POKE E,B:E = E + 1: GOTO 65040
65100  REM CONFIGURA USR()
65110  DATA 771
65120  DATA 195,176,60,-1
65130  REM ROTINA DE IMPRESSAO EM HGR
65140  DATA 15536
65150  DATA 205,161,232,200,71,35,35,78,35,102,105,229,33,21,1,86,35,94,33,,128,25,235,225,205,134,200,126,214,32,56,41
65160  DATA 229,213,197,38,,111,41,41,41,1,,61,9,58,82,3,214,1,159,47,79,6,8,126,169,18,35,123,198,32,95,122
65170  DATA 206,,87,16,242,193,209,225,19,35,16,207,195,121,200,-1
65180  REM TABELA DE CARACTERES
65190  DATA 15616
65200  DATA ,,,,,,,,16,16,16,16,16,,16,,40,40,40,,,,,,40,40,124,40,124,40,40,
65210  DATA 16,60,80,56,20,120,16,,96,100,8,16,32,76,12,,32,80,80,32,84,72,52,,16,16,16,,,,,
65220  DATA 8,16,32,32,32,16,8,,32,16,8,8,8,16,32,,16,84,56,16,56,84,16,,,16,16,124,16,16,,
65230  DATA ,,,,16,16,32,,,,,124,,,,,,,,,,,16,,,4,8,16,32,64,,
65240  DATA 56,68,76,84,100,68,56,,16,48,16,16,16,16,56,,56,68,4,24,32,64,124,,124,4,8,24,4,68,56,
65250  DATA 8,24,40,72,124,8,8,,124,64,120,4,4,68,56,,28,32,64,120,68,68,56,,124,4,8,16,32,32,32,
65260  DATA 56,68,68,56,68,68,56,,56,68,68,60,4,8,112,,,,16,,16,,,,,,16,,16,16,32,
65270  DATA 8,16,32,64,32,16,8,,,,124,,124,,,,32,16,8,4,8,16,32,,56,68,8,16,16,,16,
65280  DATA 56,68,84,92,88,64,60,,16,40,68,68,124,68,68,,120,68,68,120,68,68,120,,56,68,64,64,64,68,56,
65290  DATA 120,68,68,68,68,68,120,,124,64,64,120,64,64,124,,124,64,64,120,64,64,64,,60,64,64,64,76,68,60,
65300  DATA 68,68,68,124,68,68,68,,56,16,16,16,16,16,56,,4,4,4,4,4,68,56,,68,72,80,96,80,72,68,
65310  DATA 64,64,64,64,64,64,124,,68,108,84,84,68,68,68,,68,68,100,84,76,68,68,,56,68,68,68,68,68,56,
65320  DATA 120,68,68,120,64,64,64,,56,68,68,68,84,72,52,,120,68,68,120,80,72,68,,56,68,64,56,4,68,56,
65330  DATA 124,16,16,16,16,16,16,,68,68,68,68,68,68,56,,68,68,68,68,68,40,16,,68,68,68,84,84,108,68,
65340  DATA 68,68,40,16,40,68,68,,68,68,40,16,16,16,16,,124,4,8,16,32,64,124,,124,96,96,96,96,96,124,
65350  DATA ,64,32,16,8,4,,,124,12,12,12,12,12,124,,,,16,40,68,,,,,,,,,,,127
65360  DATA 32,16,8,,,,,,,,56,4,60,68,60,,64,64,120,68,68,68,120,,,,60,64,64,64,60,
65370  DATA 4,4,60,68,68,68,60,,,,56,68,124,64,60,,24,36,32,120,32,32,32,,,,56,68,68,60,4,56
65380  DATA 64,64,120,68,68,68,68,,16,,48,16,16,16,56,,8,,24,8,8,8,72,48,64,64,68,72,112,72,68,
65390  DATA 48,16,16,16,16,16,56,,,,108,84,84,84,68,,,,120,68,68,68,68,,,,56,68,68,68,56,
65400  DATA ,,120,68,68,120,64,64,,0,60,68,68,60,4,4,,,92,96,64,64,64,,,,60,64,56,4,120,
65410  DATA 32,32,120,32,32,36,24,,,,68,68,68,76,52,,,,68,72,40,48,16,,,,68,68,84,84,108,
65420  DATA ,,68,40,16,40,68,,,,68,72,40,48,16,96,,,124,8,16,32,124,,28,48,48,96,48,48,28,
65430  DATA 16,16,16,,16,16,16,,112,24,24,12,24,24,112,,44,80,,,,,,,,16,36,72,16,36,72,
65440  DATA -1,-1
