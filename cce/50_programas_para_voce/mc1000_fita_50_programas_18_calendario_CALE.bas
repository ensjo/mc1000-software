0  REM ************************
1  REM *     - CCESOFT -      *
2  REM *OTTO LONGO SERNATINGER*
3  REM *  VERSAO 1.1   05/85  *
4  REM ************************
5  REM *      CALENDARIO      *
6  REM ************************
2  HOME : PRINT : PRINT  TAB( 11)"- CCESOFT -": PRINT : PRINT  TAB( 13)"ATENCAO": PRINT : PRINT  TAB( 7)"ESTE PROGRAMA SUPOE": PRINT  TAB( 8)"QUE VOCE ENTRARA'": PRINT  TAB( 8)"COM DATAS VALIDAS"
3  FOR A = 1 TO 1500: NEXT A
4  HOME : PRINT : PRINT  TAB( 11)"- CCESOFT -": PRINT : INVERSE : PRINT  SPC( 6);"C A L E N D A R I O"; SPC( 7): NORMAL 
5  PRINT : PRINT : PRINT "SELECIONE:": PRINT : PRINT : PRINT "1- NUMERO DE DIAS ENTRE DATAS": PRINT : PRINT "2- DIA DA SEMANA"
6  PRINT : PRINT : PRINT : PRINT  TAB( 10);"OPCAO ";: INPUT A$
7  IF A$ = "1" THEN 10
8  IF A$ = "2" THEN 5000
9  RUN 
10  HOME : PRINT : PRINT  TAB( 11)"- CCESOFT -": PRINT : PRINT "  CALCULO DE DIAS ENTRE DATAS": GOSUB 10000
11  INPUT "PRIMEIRA DATA ";D,M,A
20  GOSUB 200
30 C1 = C
40  PRINT : INPUT "SEGUNDA DATA ";D,M,A
50  GOSUB 200
60 C3 = C - C1
70  HOME 
80  PRINT : PRINT : PRINT : PRINT : PRINT : PRINT  SPC( 6);"O NUMERO DE DIAS ENTRE": PRINT  SPC( 8);"AS DATAS E'";C3: GOTO 20000
200 B = 100
210  GOSUB 500:Y = F
220 N = 0
230  IF M > 2 THEN 300
240 N =  2
250  IF Y = 0 THEN 280
260 Z = Y:B = 4
265  GOSUB 500:R = F
270  IF R <  > 0 THEN 300
275  GOTO  295
280 B = 4: GOSUB 500
285  IF F <  > 0 THEN 300
295 N = 1
300 C =  INT (365.25 * Y) +  INT (30.56 * M) + N + D
310  RETURN 
500 F = A - B *  INT (A / B)
510  RETURN 
4995  REM *********************
5000  REM     DIA DA SEMANA
5005  REM *********************
5010  DATA SEGUNDA,TERCA,QUARTA,QUINTA,SEXTA,SABADO,DOMINGO
5020  HOME : PRINT : PRINT  TAB( 11)"- CCESOFT -": PRINT : PRINT  SPC( 10);"DIA DA SEMANA"
5030  GOSUB 10000
5040  INPUT "QUAL A DATA ";D,M,A
5050  GOSUB 5070
5060  FOR Q = 1 TO Z: READ D$: NEXT Q
5061  IF Q < 7 THEN D$ = D$ + "-FEIRA"
5062 D$ =  STR$ (D) + " /" +  STR$ (M) + " /" +  STR$ (A) + " -> " + D$
5063  HOME : PRINT : PRINT : PRINT D$
5065  GOTO 20000
5070 N =  INT (.6 + 1 / M)
5080 L = A - N
5090 P = M + 12 * N
5100 Y1 =  INT (L / 100)
5110 Z1 =  INT (L / 400)
5120 Z3 =  INT (L * 1.25)
5130 Z4 =  INT (13 * (P + 1) / 5)
5140 Z = Z4 + Z3 - Y1 + Z1 + D + 5
5150 Z = Z - (7 *  INT (Z / 7)) + 1
5160  RETURN 
10000  PRINT : PRINT : PRINT  SPC( 6);"AS DATAS DEVEM ENTRAR": PRINT  SPC( 7);"NA FORMA DD,MM,AAAA": PRINT : PRINT : RETURN 
20000  PRINT : PRINT : PRINT "   ";: INVERSE : PRINT "N";: NORMAL : PRINT "OVAMENTE , ";: INVERSE : PRINT "M";: NORMAL : PRINT "ENU OU ";: INVERSE : PRINT "B";: NORMAL : PRINT "ASIC ";
20100  INPUT A$: IF A$ <  > "N" AND A$ <  > "M" AND A$ <  > "B" THEN 20100
20300  IF A$ = "M" THEN  CLEAR : RUN 
20350  IF A$ = "N" AND D$ = "" THEN  CLEAR : GOTO 10
20360  IF A$ = "N" THEN  CLEAR : GOTO 5000
20400  HOME 
